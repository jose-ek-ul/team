(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[637],{9264:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/edit",function(){return n(3161)}])},3114:function(e,t){"use strict";t.Z="https://ulmxteam.azurewebsites.net/api"},3014:function(e,t,n){"use strict";n.d(t,{Z:function(){return ChipsArray}});var a=n(5893),i=n(7294),s=n(948),r=n(7918),l=n(629);let o=(0,s.ZP)("li")(e=>{let{theme:t}=e;return{margin:t.spacing(.5)}});function ChipsArray(e){let{chips:t,handleDelete:n}=e;return(0,a.jsx)(l.Z,{sx:{display:"flex",justifyContent:"center",flexWrap:"wrap",listStyle:"none",p:.5,m:0,width:"46ch"},component:"ul",children:i.Children.toArray(t.map((e,t)=>(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(o,{children:(0,a.jsx)(r.Z,{label:e,onDelete:void 0===n?void 0:()=>n(e)})})})))})}},3161:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return EditForm}});var a=n(5893),i=n(7294),s=n(6886),r=n(5861),l=n(1903),o=n(5582),d=n(6720),c=n(7357),h=n(3321),u=n(3014),m=n(8767),p=n(3114),f=n(1163),x=n(5885),g=n(8703),b=n(1737);function EditForm(){let e=(0,f.useRouter)(),t=new x.Z,[n,j]=i.useState(!1),[v,y]=i.useState(""),[Z,C]=i.useState("warning"),handleClose=(e,t)=>{"clickaway"!==t&&j(!1)},w=t.get("id"),[P,_]=(0,i.useState)({id:"",firstName:"",lastName:"",email:"",imageProfile:"",city:"",state:"",jobPosition:"",hobbies:[]}),[E,N]=(0,i.useState)(),[S,k]=(0,i.useState)(""),handleAdd=e=>{let t=e.target.value;t.includes(",")||k(t)},fetchUsers=async()=>{let n={mode:"cors",headers:{Authorization:"Bearer ".concat(t.get("access_token")),"Access-Control-Allow-Origin":"*","Content-Type":"application/json"}},a=await fetch("".concat(p.Z,"/User/")+w,n);if(200==a.status)return a.json();throw 401==a.status&&(t.remove("id",{path:"/"}),t.remove("access_token",{path:"/"}),t.remove("image",{path:"/"}),e.push("/signin")),Error("".concat(a.status))},{isLoading:W,isError:A,data:F,error:O}=(0,m.useQuery)("users",fetchUsers,{refetchOnWindowFocus:!1,onSuccess:_});if(O)return e.push("/error"),(0,a.jsx)(a.Fragment,{});if(W)return(0,a.jsx)("span",{children:"Loading..."});let handleUpdateUser=async e=>{var n;e.preventDefault();let a=new FormData;a.append("Id",w?w.toString():""),a.append("City",P.city),a.append("State",P.state),E&&a.append("ImageProfile",E),null===(n=P.hobbies)||void 0===n||n.forEach(e=>{a.append("Hobbies",e)});let i={method:"POST",headers:{Authorization:"Bearer ".concat(t.get("access_token"))},body:a};fetch("".concat(p.Z,"/User/Edit"),i).then(e=>e.ok?e.json():e.text().then(e=>{throw Error(e)})).then(e=>{t.set("image",e.imageProfile,{path:"/",httpOnly:!1,secure:!0}),C("success"),y("Changes saved successfully"),j(!0)}).catch(e=>{C("warning"),y(e.toString()),j(!0)})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(o.Z,{component:"main",maxWidth:"xs",children:[(0,a.jsx)(d.ZP,{}),(0,a.jsx)(c.Z,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:(0,a.jsxs)(i.Fragment,{children:[(0,a.jsx)(r.Z,{variant:"h6",gutterBottom:!0,children:"Edit profile"}),(0,a.jsxs)(s.ZP,{container:!0,spacing:3,children:[(0,a.jsx)(s.ZP,{item:!0,xs:12,sm:6,children:(0,a.jsx)(l.Z,{disabled:!0,id:"firstName",name:"firstName",label:"First name",fullWidth:!0,autoComplete:"given-name",variant:"filled",InputProps:{readOnly:!0},value:null==P?void 0:P.firstName})}),(0,a.jsx)(s.ZP,{item:!0,xs:12,sm:6,children:(0,a.jsx)(l.Z,{disabled:!0,id:"lastName",name:"lastName",label:"Last name",fullWidth:!0,autoComplete:"family-name",variant:"filled",value:null==P?void 0:P.lastName,InputProps:{readOnly:!0}})}),(0,a.jsx)(s.ZP,{item:!0,xs:12,sm:6,children:(0,a.jsx)(l.Z,{id:"city",name:"city",label:"City",fullWidth:!0,variant:"standard",value:null==P?void 0:P.city,onChange:e=>{_({...P,city:e.target.value})}})}),(0,a.jsx)(s.ZP,{item:!0,xs:12,sm:6,children:(0,a.jsx)(l.Z,{id:"state",name:"state",label:"State/Province/Region",fullWidth:!0,variant:"standard",value:null==P?void 0:P.state,onChange:e=>{_({...P,state:e.target.value})}})}),(0,a.jsxs)(s.ZP,{item:!0,xs:12,children:[(0,a.jsx)(l.Z,{id:"hobbies",name:"hobbies",label:"Hobbies",fullWidth:!0,variant:"standard",helperText:"ex: netflix, got",value:S,onChange:e=>{handleAdd(e)},onKeyDown:e=>{(","==e.key||"Enter"==e.key)&&(console.log("guardado"),P.hobbies.push(S),_({...P,hobbies:P.hobbies}),k(""))}}),(0,a.jsx)(u.Z,{chips:P.hobbies,handleDelete:e=>{let t=P.hobbies.filter(t=>t!==e);_({...P,hobbies:t})}})]}),(0,a.jsx)(s.ZP,{item:!0,xs:12,children:(0,a.jsx)(l.Z,{id:"image",name:"image",inputProps:{accept:"image/png, image/jpeg"},helperText:"Image Profile",fullWidth:!0,type:"file",onChange:e=>{let t=e.target;N(t.files[0])}})})]}),(0,a.jsx)(h.Z,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},onClick:handleUpdateUser,children:"Update"})]})})]}),(0,a.jsx)(g.Z,{open:n,anchorOrigin:{vertical:"top",horizontal:"right"},autoHideDuration:6e3,onClose:handleClose,children:(0,a.jsx)(b.Z,{onClose:handleClose,severity:Z,sx:{width:"100%"},children:v})})]})}}},function(e){e.O(0,[977,903,369,918,774,888,179],function(){return e(e.s=9264)}),_N_E=e.O()}]);