(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[637],{9264:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/edit",function(){return a(2533)}])},3114:function(e,t){"use strict";t.Z="https://ulmxteam.azurewebsites.net/api"},3014:function(e,t,a){"use strict";a.d(t,{Z:function(){return ChipsArray}});var n=a(5893),i=a(7294),s=a(948),r=a(7918),l=a(629);let o=(0,s.ZP)("li")(e=>{let{theme:t}=e;return{margin:t.spacing(.5)}});function ChipsArray(e){let{chips:t,handleDelete:a}=e,s=void 0===t||0==t.length;return(0,n.jsx)(l.Z,{sx:{display:"flex",justifyContent:"center",flexWrap:"wrap",listStyle:"none",p:s?0:.5,m:0,width:"46ch"},component:"ul",children:i.Children.toArray(t.map((e,t)=>(0,n.jsx)(o,{children:(0,n.jsx)(r.Z,{label:e,onDelete:void 0===a?void 0:()=>a(e)})})))})}},2533:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return EditForm}});var n=a(5893),i=a(7294),s=a(6886),r=a(5861),l=a(1903),o=a(5582),d=a(6720),h=a(7357),c=a(3321),u=a(3014),m=a(8767),p=a(3114),f=a(1163),x=a(5885),b=a(8703),g=a(1737),y=a(6829),j=a(2359),v=a(9687);function BasicDatePicker(e){let{date:t,setDate:a}=e,[s,r]=i.useState(null);return(0,n.jsx)(j._,{dateAdapter:y.y,children:(0,n.jsx)(v.M,{label:"Birthday",value:t,onChange:a,renderInput:e=>(0,n.jsx)(l.Z,{...e,helperText:"Year will not be displayed",fullWidth:!0,variant:"standard"})})})}var Z=a(7484),P=a.n(Z);function EditForm(){let e=(0,f.useRouter)(),t=new x.Z,[a,y]=i.useState(!1),[j,v]=i.useState(""),[Z,C]=i.useState("warning"),handleClose=(e,t)=>{"clickaway"!==t&&y(!1)},w=t.get("id"),[_,S]=(0,i.useState)({id:"",firstName:"",lastName:"",email:"",imageProfile:"",city:"",state:"",birthday:"",jobPosition:"",hobbies:[]}),[k,D]=(0,i.useState)(),[E,N]=(0,i.useState)(""),[W,A]=i.useState(null),handleAdd=e=>{let t=e.target.value;t.includes(",")||N(t)},fetchUsers=async()=>{let a={mode:"cors",headers:{Authorization:"Bearer ".concat(t.get("access_token")),"Access-Control-Allow-Origin":"*","Content-Type":"application/json"}},n=await fetch("".concat(p.Z,"/User/")+w,a);if(200==n.status)return n.json();throw 401==n.status&&(t.remove("id",{path:"/"}),t.remove("access_token",{path:"/"}),t.remove("image",{path:"/"}),e.push("/signin")),Error("".concat(n.status))},{isLoading:O,isError:U,data:B,error:F}=(0,m.useQuery)("users",fetchUsers,{refetchOnWindowFocus:!1,onSuccess:S});if(F)return e.push("/error"),(0,n.jsx)(n.Fragment,{});if(O)return(0,n.jsx)("span",{children:"Loading..."});let handleUpdateUser=async e=>{var a;e.preventDefault();let n=new FormData;n.append("Id",w?w.toString():""),n.append("City",_.city),n.append("State",_.state),n.append("Birthday",W?W.format("YYYY-MM-DD"):""),k&&n.append("ImageProfile",k),null===(a=_.hobbies)||void 0===a||a.forEach(e=>{n.append("Hobbies",e)});let i={method:"POST",headers:{Authorization:"Bearer ".concat(t.get("access_token"))},body:n};fetch("".concat(p.Z,"/User/Edit"),i).then(e=>e.ok?e.json():e.text().then(e=>{throw Error(e)})).then(e=>{t.set("image",e.imageProfile,{path:"/",httpOnly:!1,secure:!0}),C("success"),v("Changes saved successfully"),y(!0)}).catch(e=>{C("warning"),v(e.toString()),y(!0)})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(o.Z,{component:"main",maxWidth:"xs",children:[(0,n.jsx)(d.ZP,{}),(0,n.jsx)(h.Z,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:(0,n.jsxs)(i.Fragment,{children:[(0,n.jsx)(r.Z,{variant:"h6",gutterBottom:!0,children:"Edit profile"}),(0,n.jsxs)(s.ZP,{container:!0,spacing:3,children:[(0,n.jsx)(s.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(l.Z,{disabled:!0,id:"firstName",name:"firstName",label:"First name",fullWidth:!0,autoComplete:"given-name",variant:"filled",InputProps:{readOnly:!0},value:null==_?void 0:_.firstName})}),(0,n.jsx)(s.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(l.Z,{disabled:!0,id:"lastName",name:"lastName",label:"Last name",fullWidth:!0,autoComplete:"family-name",variant:"filled",value:null==_?void 0:_.lastName,InputProps:{readOnly:!0}})}),(0,n.jsx)(s.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(l.Z,{id:"city",name:"city",label:"City",fullWidth:!0,variant:"standard",value:null==_?void 0:_.city,onChange:e=>{S({..._,city:e.target.value})}})}),(0,n.jsx)(s.ZP,{item:!0,xs:12,sm:6,children:(0,n.jsx)(l.Z,{id:"state",name:"state",label:"State/Province/Region",fullWidth:!0,variant:"standard",value:null==_?void 0:_.state,onChange:e=>{S({..._,state:e.target.value})}})}),(0,n.jsx)(s.ZP,{item:!0,xs:12,children:""===_.birthday?(0,n.jsx)(BasicDatePicker,{date:W,setDate:A}):(0,n.jsx)(l.Z,{disabled:!0,id:"birthday",name:"birthday",label:"Birthday",fullWidth:!0,variant:"filled",InputProps:{readOnly:!0},value:function(){if(""===_.birthday)return"";let e=P()(_.birthday);return e.format("MMMM D")}()})}),(0,n.jsxs)(s.ZP,{item:!0,xs:12,children:[(0,n.jsx)(l.Z,{id:"hobbies",name:"hobbies",label:"Hobbies",fullWidth:!0,variant:"standard",helperText:"ex: netflix, got",value:E,onChange:e=>{handleAdd(e)},onKeyDown:e=>{(","==e.key||"Enter"==e.key)&&(_.hobbies.push(E),S({..._,hobbies:_.hobbies}),N(""))}}),(0,n.jsx)(u.Z,{chips:_.hobbies,handleDelete:e=>{let t=_.hobbies.filter(t=>t!==e);S({..._,hobbies:t})}})]}),(0,n.jsx)(s.ZP,{item:!0,xs:12,children:(0,n.jsx)(l.Z,{id:"image",name:"image",inputProps:{accept:"image/png, image/jpeg"},helperText:"Image Profile",fullWidth:!0,type:"file",onChange:e=>{let t=e.target;D(t.files[0])}})})]}),(0,n.jsx)(c.Z,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},onClick:handleUpdateUser,children:"Update"})]})})]}),(0,n.jsx)(b.Z,{open:a,anchorOrigin:{vertical:"top",horizontal:"right"},autoHideDuration:6e3,onClose:handleClose,children:(0,n.jsx)(g.Z,{onClose:handleClose,severity:Z,sx:{width:"100%"},children:j})})]})}}},function(e){e.O(0,[977,190,369,948,673,774,888,179],function(){return e(e.s=9264)}),_N_E=e.O()}]);